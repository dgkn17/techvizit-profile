<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TechVizit Profil</title>
  <style>
    * {margin:0;padding:0;box-sizing:border-box}
    body {
      font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
      background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%);
      min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px;
    }
    .profile-card {
      background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%);
      border-radius:24px;box-shadow:0 8px 30px rgba(0,0,0,0.1);
      padding:40px 30px;max-width:400px;width:100%;position:relative;overflow:hidden;text-align:center;
    }
    .profile-card::before {
      content:'';position:absolute;top:-50px;right:-50px;width:200px;height:200px;
      background:rgba(108,92,231,.05);border-radius:50%;z-index:0;
    }
    .profile-card::after {
      content:'';position:absolute;bottom:-30px;left:-30px;width:150px;height:150px;
      background:rgba(116,185,255,.05);border-radius:50%;z-index:0;
    }
    .content{position:relative;z-index:1}
    .profile-image {
      width:100px;height:100px;border-radius:50%;border:4px solid white;
      box-shadow:0 4px 15px rgba(0,0,0,.1);background:rgba(108,92,231,.1);
      display:flex;align-items:center;justify-content:center;font-size:40px;color:#6c5ce7;margin:0 auto 24px;
    }
    .pro-badge {
      background:#00b894;color:white;padding:6px 12px;border-radius:12px;
      font-size:12px;font-weight:bold;position:absolute;top:20px;right:20px;
    }
    .name{font-size:24px;font-weight:bold;color:#2d3436;margin-bottom:4px}
    .title{font-size:14px;color:#636e72;font-weight:600;letter-spacing:1.2px;text-transform:uppercase;margin-bottom:24px}
    .detail-item {display:flex;align-items:center;justify-content:center;margin:12px 0;color:#636e72;font-size:14px}
    .detail-item svg{width:16px;height:16px;margin-right:8px;fill:currentColor}
    .contact-buttons{margin-top:30px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
    .contact-btn{padding:10px 20px;border:none;border-radius:12px;color:white;text-decoration:none;
      font-weight:600;font-size:12px;transition:transform .2s,box-shadow .2s;display:inline-flex;align-items:center;gap:8px}
    .contact-btn:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(0,0,0,.2)}
    .btn-email{background:linear-gradient(135deg,#6c5ce7,#a29bfe)}
    .btn-phone{background:linear-gradient(135deg,#00b894,#00cec9)}
    .btn-website{background:linear-gradient(135deg,#e17055,#fd79a8)}
    .nfc-indicator{margin-top:20px;padding:15px;background:linear-gradient(135deg,#6c5ce7,#74b9ff);
      border-radius:15px;color:white;font-size:12px;font-weight:600;display:flex;align-items:center;justify-content:center;gap:8px}
    .pulse{animation:pulse 2s infinite}
    @keyframes pulse{0%{opacity:1}50%{opacity:.7}100%{opacity:1}}
    @media(max-width:480px){
      .profile-card{margin:10px;padding:30px 20px}
      .name{font-size:20px}
      .contact-buttons{flex-direction:column}
      .contact-btn{width:100%;justify-content:center}
    }
  </style>
</head>
<body>
  <div class="profile-card">
    <div class="pro-badge">Pro</div>
    <div class="content">
      <div class="profile-image" id="profileImage">ðŸ“·</div>
      <div class="name" id="userName">KullanÄ±cÄ± AdÄ±</div>
      <div class="title" id="userTitle">ÃœNVAN</div>

      <div class="detail-item"><svg viewBox="0 0 24 24"><path d="M12,2A10,10 ..."/></svg><span id="companyName">TechVizit</span></div>
      <div class="detail-item"><svg viewBox="0 0 24 24"><path d="M20,8L12,13 ..."/></svg><span id="userEmail">user@example.com</span></div>
      <div class="detail-item"><svg viewBox="0 0 24 24"><path d="M6.62,10.79 ..."/></svg><span id="userPhone">Telefon</span></div>
      <div class="detail-item" id="websiteItem" style="display:none"><svg viewBox="0 0 24 24"><path d="M16.36,14 ..."/></svg><span id="userWebsite">Website</span></div>
      <div class="detail-item" id="addressItem" style="display:none"><svg viewBox="0 0 24 24"><path d="M12,11.5 ..."/></svg><span id="userAddress">Adres</span></div>

      <div class="contact-buttons">
        <a href="#" class="contact-btn btn-email" id="emailBtn">E-POSTA</a>
        <a href="#" class="contact-btn btn-phone" id="phoneBtn">ARA</a>
        <a href="#" class="contact-btn btn-website" id="websiteBtn" style="display:none">WEBSÄ°TE</a>
      </div>

      <div class="nfc-indicator pulse">NFC KARTINDAN YÃ–NLENDÄ°RÄ°LDÄ°NÄ°Z</div>
    </div>
  </div>

<script>
(async function(){
  const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzIgJz5eaK4EXk5i24ixpRauDT3wsTbv3eq4F-F4TyS5wQ_OgusS5uX8TT658_Kg4XLcw/exec';
  const DEFAULT_PROFILE = location.href; // fallback

  const params = new URLSearchParams(location.search);
  const uid = params.get('uid') || '0';
  const to = params.get('to') || '';
  const data = params.get('data') || '';

  // Log payload
  const payload = {
    uid: uid,
    data: data,
    userAgent: navigator.userAgent || '',
    platform: navigator.platform || '',
    screen: (screen && screen.width ? (screen.width + 'x' + screen.height) : ''),
    referrer: document.referrer || '',
    ts: new Date().toISOString()
  };

  try {
    const controller = new AbortController();
    setTimeout(()=> controller.abort(),1500);
    await fetch(APPS_SCRIPT_URL,{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify(payload),signal:controller.signal,mode:'cors',credentials:'omit'
    });
  } catch(e){/* sessiz */ }

  // Profil datasÄ±nÄ± ekrana yansÄ±t
  function updateProfile(obj){
    document.getElementById('userName').textContent=obj.name||'KullanÄ±cÄ± AdÄ±';
    document.getElementById('userTitle').textContent=(obj.title||'ÃœNVAN').toUpperCase();
    document.getElementById('companyName').textContent=obj.company||'TechVizit';
    document.getElementById('userEmail').textContent=obj.email||'user@example.com';
    document.getElementById('userPhone').textContent=obj.phone||'Telefon';
    document.getElementById('emailBtn').href='mailto:'+(obj.email||'');
    document.getElementById('phoneBtn').href='tel:'+(obj.phone||'');
    if(obj.website){document.getElementById('userWebsite').textContent=obj.website;
      document.getElementById('websiteItem').style.display='flex';
      document.getElementById('websiteBtn').style.display='inline-flex';
      document.getElementById('websiteBtn').href=obj.website.startsWith('http')?obj.website:'https://'+obj.website;}
    if(obj.address){document.getElementById('userAddress').textContent=obj.address;
      document.getElementById('addressItem').style.display='flex';}
  }

  try {
    if(data){
      const decoded=JSON.parse(atob(data));
      updateProfile(decoded);
    }
  } catch(e){}

  // EÄŸer "to" param varsa ilgili profile yÃ¶nlendir
  if(to){
    const dest=decodeURIComponent(to);
    const sep=dest.indexOf('?')===-1?'?':'&';
    location.replace(dest+sep+'data='+encodeURIComponent(data));
  }
})();
</script>
</body>
</html>
